---
title: 锁
toc: true
date: 2017-01-09 15:55:06
category: 
	- 技术贴
	- 理论与概念
tags: 
    - 锁 并发
---


# 锁
锁，顾名思义，就是把一定的资源加上某种限制，提高安全性，绝大部分房间都是有门的，而门内一般都是有锁，对整个空间起到保护作用，在软件工程中也是如此，尤其是数据库，数据就是资源，而加锁是为了保护数据不出现（如：脏读，幻读，更新丢失等）

## 乐观锁&悲观锁
### 乐观锁
世界很美好，大家都很和平，拿数据时不会去上锁，但是在更新操作时会检查数据时效性，可以理解为一种弱锁机制。
<!--more-->
#### 实现
1.version
将表新增一列字段，如version,每次读取数据时同时带上version,更新操作时与库中数据进行version校验，相同则更新，不同则失败。

### 悲观锁
悲天悯人，觉得全世界都不公平，所以要实现绝对的公平，每次操作都要上锁，保证了数据的强一致性，同样也会带来性能损耗。

#### 实现
1.加锁－ －

## 死锁&活锁
### 死锁
记得大学操作系统课程中都是重点考试内容，翻出了大学的笔记。。
产生死锁的四个必要条件：
（1） 互斥条件：一个资源每次只能被一个进程使用。
（2） 请求与保持条件：一个进程因请求资源而阻塞时，对已获得的资源保持不放。
（3） 不剥夺条件:进程已获得的资源，在末使用完之前，不能强行剥夺。
（4） 循环等待条件:若干进程之间形成一种头尾相接的循环等待资源关系。

### 活锁
与死锁相对，死锁是两个线程拼命抢夺资源，谁也互不相让，而活锁恰恰相反，是两个线程都让出了自己目前获取到的资源，结果也处于一种阻塞的状态。